---
title: "Сравнение разумно-приватных трат в сетях Bitcoin, Monero и Zcash"
date: "2021-11-29"
categories:
  - "Статьи"
tags:
  - ""
lead: "В своем первом посте я хотел поделиться некоторыми мыслями об эффективности типов транзакций при сравнении протоколов, обеспечивающих приватность данных, и способов их использования."
pager: true
toc: true
sidebar: "right"
---

## _Введение_

Недавно я подробно обсуждал этот вопрос в Twitter, и был удивлён результатами, обнаружив, что Monero может оказаться даже эффективнее с точки зрения размера транзакций в сравнении с Bitcoin, если использовать обе криптовалюты приватно. Я посвящу этот пост более подробному рассмотрению проблемы и добавлю к предшествующим нового претендента — Zcash.

>Из Twitter:  
1/ Сравнение «разумно приватных» трат в сетях  #Monero и #Bitcoin и попытка найти лучший способ оценки масштабируемости / пропускной способности, если при любом расходовании средств обеспечивается разумный/хороший уровень приватности. Начнём с размеров транзакций, или, точнее, с «объёма приватной траты»  
— Seth For Privacy (@sethforprivacy) 20 июля 2020 г.

Причина, по которой я решил сфокусировать внимание на эффективности каждого протокола, состоит в том, что пользователи, как правило, отдают предпочтение простоте и малым затратам, и если приватный протокол может обеспечить и то, и другое, они могут в значительной степени поспособствовать внедрению мощных инструментов. Несмотря на то, что пользователи, как правило, предпочитают приватность (думаю, никто из читателей не захочет прислать мне все свои пароли и домашний адрес по электронной почте), они, как правило, не делают всего возможного, требующего больших временных и финансовых затрат, чтобы обеспечить приватность собственных данных.

Итак, в этом посте мы рассмотрим, как каждый из трёх наиболее известных подходов к обеспечению приватности при использовании криптовалют характеризуется с точки зрения размера транзакций, затрат (как финансовых, так и временных) и пропускной способности.

Но сперва ознакомимся с подходом к обеспечению приватности каждой из сетей.

### _Bitcoin — приватность, обеспечиваемая кошельком_

[Bitcoin](https://bitcoin.org/en/) — король криптовалют. Он стал крупным прорывом, благодаря которому появились такие криптовалюты, как [Monero](https://www.getmonero.org/) и [Zcash](https://z.cash/). Несмотря на то, что многие вначале сочли такой подход к обеспечению приватности достаточным, люди быстро поняли, что предлагаемая им псевдонимность является недостаточной для целого ряда сценариев использования и позволяет пользователям с лёгкостью нарушить собственную приватность, например, путём объединения выходов, повторного использования адресов и, помимо прочих эвристических методов, простого анализа сумм в выходах.

В настоящее время Bitcoin использует два основных подхода к обеспечению определённого уровня «разумной приватности»: применение технологии CoinJoin[^1] в целях обфускации обладания UTXO и технологии Lightning Network[^2] для переноса следов перемещения средств за пределы сети (в некоторой степени работа над методом обеспечения приватности посредством Lightning пока ещё не завершена и сама технология не совсем понятна).

CoinJoin — это технология, при использовании которой группа уникальных пользователей использует центрального координатора для создания общей транзакции, в которой объединяются все их входящие UTXO с одной и той же фиксированной суммой, а затем эти средства «смешиваются», позволяя разорвать детерминированные связи между входящими UTXO и адресами, которым принадлежат выходы. Наиболее известными подходами в данном случае являются [Samourai](https://samouraiwallet.com/), [Wasabi](https://www.wasabiwallet.io/) и [JoinMarket](https://github.com/Joinmarket-Org/joinmarket-clientserver/releases) (обратите внимание, что JoinMarket использует модель создателя/приобретателя вместо модели координатора, но это уже выходит за рамки темы данного поста).

В этом посте мы сосредоточим основное внимание на кошельке Samourai, так как на данный момент он наиболее широко признан в качестве идеального инструмента обеспечения приватности при использовании Bitcoin. Дополнительная информация по базовым принципам работы Samourai Wallet можно найти здесь: [Samourai 101](https://www.bitcoinqna.com/post/samourai-101).

### _Monero — обеспечение приватности по умолчанию_

[Monero](https://www.getmonero.org/) была создана небольшим сообществом разработчиков в 2014 году как форк проекта под названием Bytecoin. Monero не является форком Bitcoin и использует совершенно новую кодовую базу, Cryptonote[^3], которая эволюционировала в протокол Monero. Проект Monero был задуман для реализации трёх основных целей: обеспечение приватности, доступной широким массам, по умолчанию, обеспечение масштабируемого и итеративного базового уровня, и устойчивость к использованию схем ASIC, позволяющая заниматься майнингом при помощи обычного оборудования, что способствует децентрализации.

Monero обеспечивает приватность всех пользователей сети по умолчанию различными способами:
- RingCT[^4]: эта технология позволяет скрыть все отправляемые и получаемые суммы в блокчейне (посредством проведения конфиденциальных транзакций[^5]), а также скрыть, какие именно выходы при этом тратятся (на данный момент) среди 10 других выходов (посредством кольцевых подписей[^6]). Процесс не требует никакой координации, совершенно не интерактивен (в отличие от CoinJoin) и полностью реализуется самим протоколом.
- Скрытые адреса[^7]: данная технология позволяет скрыть адреса отправителя и получателя в блокчейне. При этом отправитель при помощи публичного ключа получателя генерирует одноразовый адрес, и поэтому, фактические адреса никогда не публикуются в блокчейне.
- Dandelion++[^8]: эта технология помогает скрыть IP-адрес отправителя при отправке Monero. Для этого используется специальный метод ретрансляции транзакций через другие узлы.

Сочетание данных технологий позволяет обеспечить довольно высокий уровень приватности любого пользователя сети Monero. При этом не требуется прилагать каких-либо дополнительных усилий, нет необходимости в совершении нескольких транзакций или в доверии к какому-либо центральному координатору.

### _Zcash — обеспечение приватности посредством пула_

[Zcash](https://z.cash) является форком кода Bitcoin, появившимся в 2016 году. При этом был добавлен дополнительный уровень приватности, для чего использовалась технология под названием zk-SNARKs[^9], позволившая пользователям отказаться от сокрытия отправителя, получателя и суммы конкретной транзакции (при отправке средств с одного z-адреса на другой z-адрес). Это работает аналогично тому, как это реализовано в Monero, так как и здесь есть одноразовые адреса, обязательства по сумме и доказательства того, что в транзакции расходуется предыдущий выход.

Zcash унаследовала многие сетевые характеристики Bitcoin, но обеспечивает гораздо более высокий уровень приватности тех пользователей, которые выберут соответствующую опцию. К сожалению, из-за того, что эти надёжные инструменты, обеспечивающие приватность, не используются всеми пользователями по умолчанию, они не находят должного внедрения и не являются чем-то самим собой разумеющимся, и большинство транзакций в сети Zcash, конечно же, подобны транзакциям Bitcoin.
Для получения более подробной дополнительной информации о том, как Zcash работает с технической точки зрения, ознакомьтесь со статьёй «[Технология Zcash](https://z.cash/technology/)».

## _Сравнение размера и затрат_

Поскольку уникальные сети довольно сложно сравнить, я сделал всё возможное, чтобы найти унифицированный набор тех показателей, которые было бы проще сопоставить. Кроме того, я использовал доллар США в качестве общей меры для комиссий, поскольку собственные единицы измерения сравнить также непросто.

Примечания по транзакциям Bitcoin

Данный пример блокчейна транзакций представляет собой рекомендуемый способ достижения «разумной приватности» и трат Bitcoin и требует проведения [транзакции предварительного смешивания TX0](https://medium.com/samourai-wallet/diving-head-first-into-whirlpool-anonymity-sets-4156a54b0bc7), [транзакции смешивания Whirlpool](https://samouraiwallet.com/whirlpool), и транзакции пост-смешивания (здесь для сравнения используется [транзакция STONEWALL](https://samouraiwallet.com/stonewall), так как она является наиболее распространённой и не требует второй доверительной части).

Важно отметить, что на выполнение одной «разумно приватной» траты уходит много времени, а при проведении мною собственного тестирования переход от TX0 к STONEWALL занял примерно 4,5 часа. Такое общее время можно несколько сократить, создав множество смешанных выходов из каждой TX0, но не все пользователи могут сделать это, так как в данном случае имеется определённая зависимость от количества входов и размера пула.

>Из Twitter:  
12/ Основные результаты (продолжение):  
*#Bitcoin остаётся чрезвычайно затратной криптовалютой с точки зрения проведения приватных транзакций, а комиссии в настоящее время (сравнительно) низкие. На приватную отправку средств потребовалось $37,50 и примерно 4,5 часа, что довольно затратно как по времени, так и финансово, даже с учётом простоты использования Samourai.  
— Seth For Privacy (@sethforprivacy) 9 июня 2020 г.

При проведении этого сравнения я пропустил затраты на «[доксические изменения](https://www.bitcoinqna.com/post/dealing-with-coinjoin-change-outputs)» и [комиссии за смешивание](https://www.whirlpoolfees.com/), поскольку они непостоянны и их трудно сравнивать в случае с транзакциями Monero и Zcash. Я просто перечислил комиссии за проведение транзакций Bitcoin ниже.

### _Примечания по транзакциям Monero_

Этот пример транзакции является стандартной транзакцией Monero, соответствующей схеме «1 вход, 2 выхода», и использует существующую сетевую технологию, а также представляет собой наиболее часто встречаемый вид траты. Обратите внимание, что в данном случае для защиты отправителя, получателя и сокрытия суммы или для разрыва каких-либо детерминированных связей не требуется никаких подготовительных транзакций, транзакций смешивания или пост-смешивания.
Отправка транзакции Monero так же проста, как и отправка базовой транзакции Bitcoin, и её подтверждение в блокчейне занимает приблизительно 2 минуты.

### _Примечания по транзакциям Zcash_

Этот пример транзакции является стандартной транзакцией Zcash, проводимой с одного z-адреса на другой z-адрес, с 1 входом и 2 выходами и обеспечивает высший уровень приватности, доступный пользователям, выбравшим такой, полностью защищённый, тип транзакции. Этот тип позволяет скрыть отправителя, получателя и сумму транзакции в блокчейне. Обратите внимание, что в данном случае для защиты отправителя, получателя и сокрытия суммы или для разрыва каких-либо детерминированных связей не требуется никаких подготовительных транзакций, транзакций смешивания или пост-смешивания.

### _Результаты_

Как можно увидеть ниже, из трёх сетей Monero предлагает наиболее затратные и компактные транзакции, что позволяет сэкономить почти 900b при совершении «разумно приватных» трат, если сравнивать с сопоставимыми транзакциями Bitcoin и Zcash, а затраты составляют 33% от затрат Zcash и 0,0002%. от затрат Bitcoin.

Самая большая оговорка в отношении масштабирования Monero заключается в том, что в настоящее время Monero обрезать в полной мере, как это делается в случае с Bitcoin (Bitcoin можно обрезать вплоть до текущего набора UTXO), и требует сохранения базы данных всех выходов для использования в качестве ложных в каждой из будущих транзакций, никогда не известно, был ли потрачен выход в сети[^10]. Zcash (насколько я могу судить) в настоящее время никак не обрезается.

Важно отметить, что большинство пользователей Zcash и Bitcoin не используют эти инструменты, обеспечивающие приватность, а вместо этого в большинстве случаев предпочитают совершать транзакции, не скрывая отправителя/получателя/сумму.

Дополнительная сравнительная информация по частоте использования этих инструментов содержится в недавно созданной @JEhrenhofer в Twitter:

>Из Twitter:  
Сравнение Zcash и Monero  
Пропорциональная сумма транзакций Monero и Zcash, в которых скрываются отправитель, получатель и сумма: pic.twitter.com/Q7xY4pWoMh  
— Джастин Эренхофер (JEhrenhofer), 28 ноября 2020

| Криптовалюта | Размер транзакции | Затраты на проведение транзакции (в долларах США на 20.04.2020) |
|---|---|---|
| Bitcoin | 2,363b, 1,475vb | $41,00 (@ 50sat/vb) |
| Monero | 1,419b | $0,0208 (средняя) |
| Zcash | 2,373b | $0,0232 (средняя) |

## _Пропускная способность_

Пропускная способность — ещё более сложная для измерения сетевая метрика, поскольку каждая сеть использует свои размер блока и время блока в зависимости от собственных потребностей и целей. Чтобы найти в данном случае какую-то общую основу, я решил взять лимиты / значения времени, используемые по умолчанию каждой из сетей, и значение их пропускной способности, и сравнить их с временем блока, равным 10 минутам, и размером блока, составляющим 1 Мб/4 Мб в сети Bitcoin.

### _Примечания по сети Bitcoin_

Bitcoin сохранил 10-минутное время блока с момента создания, но размеры блоков были изменены (в некотором смысле) с введением SegWit[^11] до максимума, равного 4 Мб для собственных транзакций SegWit, и 1 Мб для «унаследованных» транзакций. Чтобы задать оптимальные сетевые условия для проведения этого сравнения, я допускаю, что SegWit был внедрён на 100%, что даже не близко к реальности, но даёт нам лучшую картину того, что в принципе возможно в случае с Bitcoin.

Более подробную информацию о том, как работает взвешивание транзакций в Bitcoin, можно найти в статье «[Каков предел размера блока после реализации SegWit?](https://bitcoin.stackexchange.com/questions/98810/whats-the-blocksize-limit-after-segwit-and-how-do-legacy-nodes-deal-with-segwit)».

### _Примечания по сети Monero_

Сеть Monero использует время блока, равное 2 минутам, но имеет более сложное предельное значение размера блока, чем у большинства других сетей. В сети Monero размеры блока имеют среднее и жёстко ограниченное значения, которые могут быть увеличены майнерами с условием выплаты штрафа, пропорционального увеличению размера передаваемого в сеть блока. Для расчётов, приводимых ниже, я выбрал жёстко ограниченное значение размера блока, используемое по умолчанию, но сеть Monero может легко и плавно масштабироваться без какого-либо вмешательства со стороны разработчиков и вне зависимости от версии программного обеспечения.

Дополнительная информация по динамическому масштабированию блоков содержится в статье «[Как в Monero решена характерная для Bitcoin проблема размера блоков](https://localmonero.co/knowledge/dynamic-block-size)».

### _Примечания по сети Zcash_

Zcash использует свойства, аналогичные свойствам сети Bitcoin, но с меньшим временем блока, составляющим всего на 1,25 минуты между блоками, а также имеет меньший размер блока, равный 2 Мб. Поскольку сеть не поддерживает SegWit, в данном случае какие-либо сложные различия с точки зрения ограничения блоков отсутствуют.

## _Результаты_

Как можно увидеть ниже, благодаря гораздо более компактным транзакциям Monero, при сравнении «разумно приватных» трат в трёх сетях имеется возможность поддержки большинства значений TPS взвешенных транзакций Bitcoin.

Следует отметить, что Zcash технически поддерживает самые высокие значения TPS при размере блоков, используемом по умолчанию, но сочетание очень короткого времени блока с полным размером блока приведёт к возникновению определённых проблем со стороны узлов и быстрому росту блокчейна.

| Криптовалюта | Время блока | Предельное значение размера блока | Макс. TPS / 10 мин | Макс. TPS / 10 мин, взвешенные в соответствии с размером блока Bitcoin | Рост блокчейна, взвешенный в соответствии с количеством транзакций Bitcoin |
|---|---|---|---|---|---|
| Bitcoin | 10 мин | Унаследованное:1 Мб, SegWit: 4 Мб | ~2,750 (SegWit) | ~2,750 (SegWit) | 0,77 Гб/d |
| Monero | 2 мин | Изначальное среднее: 300 Кб, жёсткое предельное: 2ч средних | ~2,150 | ~2,900 (SegWit) | 0,46 Гб/d |
| Zcash | 1,25 мин | 2 Мб | ~6,900 | ~1,725 (SegWit) | 0,77 Гб/d |

## _Заключение_

Подводя итоги, можно утверждать, что, хотя Monero зачастую не рассматривается в качестве инструмента, обеспечивающего приватность пользователей, из-за «проблем с масштабированием» или «неэффективности транзакций», на самом деле эта криптовалюта может похвастаться самой масштабируемой реализацией механизма обеспечения приватности среди лидеров а также постоянными итерациями, позволившими уйти от 13 Кб на транзакцию в самом начале до 1,4 Кб сегодня.

Впереди ещё предстоит долгий путь, но интересно наблюдать, как постоянный прогресс окупается при проведении сравнения «разумно приватных» трат, которое я попытался сделать.

Я понимаю, что подобное сравнение невероятно сложно произвести, и был бы признателен за любые замечания, которые бы позволили усовершенствовать этот подход, чтобы составить чёткое представление об эффективности инструмента обеспечения приватности на текущий момент.

Благодарю вас за то внимание, которое вы уделили моему первому посту, и надеюсь, что вы и в дальнейшем будете внимательно следить за моими статьями!

Если у вас есть какие-либо вопросы, связанные с этим постом, или вы хотите связаться со мной по какому-либо другому вопросу, то это можно сделать нами через [Twitter, Matrix или по электронной почте](https://blog.sethforprivacy.com/about/#how-to-contact-me).

### _Транзакции, использованные для оценки

Bitcoin
- [Транзакция предварительного смешивания TX0](https://blockstream.info/tx/5787a5eb16bb7e5e16651f5f1bdc5afde146c6f7f5b3516e1ab77c5444128fa2?output:5)
- [Транзакция смешивания Whirlpool](https://blockstream.info/tx/4e72519d391ce83e0659c9022a00344bedbb253de1747cf290162b3d3ea51479)
- [Транзакция пост-смешивания STONEWALL](https://blockstream.info/tx/ce2394b8d4d3b5be4712184b554c8b8ca6772e5baa1123482b9e50ef5bf2e8a2?input:0)

Monero
- https://xmrchain.net/search?value=66679d2326cb2f7596cb6e2e25f586c819025b9daa902c901f80fa9b41c33e41

Zcash
- https://blockchair.com/zcash/transaction/62cb32927d0fcfa6b8d5d36dfc72631191722f971b1141864fbcf73e06588d64

---

[^1]: Дополнительную информацию можно найти по следующей ссылке: https://bitcoinmagazine.com/articles/coinjoin-combining-bitcoin-transactions-to-obfuscate-trails-and-increase-privacy-1465235087

[^2]: Дополнительную информацию можно найти по следующей ссылке: https://bitcoinmagazine.com/articles/coinjoin-combining-bitcoin-transactions-to-obfuscate-trails-and-increase-privacy-1465235087

[^3]: https://cryptonote.org/whitepaper.pdf

[^4]: https://www.getmonero.org/resources/moneropedia/ringCT.html

[^5]: https://localmonero.co/knowledge/monero-ringct

[^6]: https://www.getmonero.org/resources/moneropedia/ringsignatures.html

[^7]: https://www.getmonero.org/resources/moneropedia/stealthaddress.html

[^8]: https://www.monerooutreach.org/stories/dandelion.html

[^9]: https://z.cash/technology/zksnarks/

[^10]: https://www.getmonero.org/resources/moneropedia/pruning.html

[^11]: https://bitcoinmagazine.com/what-is-bitcoin/what-is-segwit

---

_Источник: [Comparing Reasonably Private Spends in Bitcoin, Monero, and Zcash](https://blog.sethforprivacy.com/posts/comparing-private-spends/)_

_Перевод: [Mr. Pickles](https://t.me/v1docq47)_  
_Коррекция: [Kukima](https://t.me/Kukima)_
