---
title: "Дими 'm2049r' Дивак - SideKick!"
date: "2024-06-07"
categories:
  - "Стенограмма"
tags:
  - "MoneroKon 2024"
lead: "Monero Konferenco 2024 #MoneroKon2024 Прага"
pager: true
toc: false
sidebar: "right"
---

{{< youtube id="5smwR_C7p-k" autoplay="false" >}}

---

_**Аннотация выступления**_

Вслед за добавленной в прошлом году в Monerujo функцией появилась новая, которую самые активные пользователи Monero могут протестировать уже сейчас в режиме реального времени!

SideKick позволяет пользователям инициировать транзакции на своём обычном телефоне, а затем подписывать их, но уже с помощью другого запасного телефона, который работает в автономном режиме. То есть, он работает как аппаратный кошелёк, но без закрытого исходного кода и не допускает утечки данных.

Данное выступление посвящено техническим аспектам SideKick, и в нём разъясняется, как работает этот аппаратный кошелёк, а также приводится обоснование некоторых технических решений и проблем, с которыми столкнулась команда разработчиков.

_**Стенограмма выступления:**_

_**Дими:**_ Сегодня мы поговорим о SideKick. После двух лет разработки, двух с половиной, нет, трёх лет - три года назад возникла идея создания SideKick - мы поговорим о том, что это такое, зачем он нужен, и как мы решили реализовать этот кошелёк.

SideKick - это аппаратный кошелёк для широких масс, так же, как м Monorujo - кошелёк Monero для широкой публики. Исходя из этой идеи, мы решили создать альтернативу стандартным аппаратным кошелькам, которой могли бы воспользоваться обычные люди. Для меня очень важно всё реализовать таким образом, чтобы кошелёк был связан не только с Monorujo, но чтобы им мог воспользоваться любой, чтобы он интегрировался с любым клиентом. И именно поэтому он был реализован в базовом коде Moneo. Так что одним из наших следующих действий является создание соответствующего пул-реквеста. Безусловно, всё ещё нужно почистить, проверить и так далее. Мы закончили его вчера в два, а в три купили кепку с помощью SideKick, так что всё работает.

А это просто скриншот Wallet2 API, где рядом с Ledger и Trezor, о которых все вы слышали, под номером три мы добавили устройство SideKick.

Но зачем мы занялись этим? Как я уже сказал, мы хотели, чтобы кошелёк был доступен массовому пользователю. Почему люди массово не покупают, например, Ledger? Полагаю, у вас есть гораздо лучший ответ на этот вопрос, чем у меня. Но наш ответ: многим довольно сложно приобрести это оборудование, особенно через Интернет, учитывая наличие таможни, которая узнает, что у вас есть такое устройство: "Зачем вам такое устройство? Оно запрещено", - может случиться и такое. Или же, возможно, в вашей юрисдикции, некоторые компании, узнав, что у вас есть такое устройство, сделают вас мишенью. Шесть лет назад уже случались массовые утечки адресов людей, у которых была причина для покупки аппаратного кошелька. А сколько такой кошелёк стоит сегодня? Мишень на вашей спине с каждым днём становится всё больше и больше. Так что, да, одна из причин - проблемы с приватностью. Кроме того, все мы пользуемся Android, и поэтому мы решили, что Android - хороший выбор для создания подобного оборудования. Опять же, это не какое-то специальное оборудование, а готовое устройство Android, которое лежит у вас где-нибудь в коробке с кабелями, как было показано на самом первом слайде. У меня таких, как минимум, три. И теперь я нашёл им применение - тестирование SideKick.

В основе нашего решения лежат рабочие процессы Ledger. Мы давно интегрировали Ledger в Monerujo, и рабочие процессы Ledger очень хорошо задокументированы. Код, написанный под Monero, выложен на GitHub и также довольно хорошо задокументирован. Код хорош и читаем, поэтому без особого труда можно понять, как он работает, особенно в сочетании с тем, как работает код Monero, который также довольно прост.

Для обмена данными между устройством SideKick и обычным клиентом мы используем Bluetooth, то есть, Monorujo и SideKick соединяются посредством Bluetooth. Соединение Bluetooth шифруется само по себе, но даже если бы это было не так, обмен данными может происходить в виде простого текста или отправляться в открытую сеть без какого-либо шифрования, поскольку между двумя устройствами не передаётся никакой секретной информации. То есть, вся секретная информация, все секретные ключи, все секретные вычисления - а результатом всех вычислений являются некоторые секретные данные - всё это остаётся на устройстве SideKick и помечается каким-либо идентификатором.

И всё это реализовано как подкласс аппаратного устройства, что в принципе гарантирует, что кошелёк будет иметь тот же API, что у любого другого аппаратного кошелька или даже программного обеспечения. Кошелёк реализован таким образом, что когда вы запускаете клиент Monero на своём ПК, он использует тот же API для связи со своими программными аналогами. Это дат нам возможность сказать: вы можете использовать наш кошелёк, любой человек может использовать его, вы можете реализовать его в GUI-клиенте Monero и любом другом, например, Cake Wallet, то есть, любом другом кошельке. При этом всё, что нужно сделать, это убедиться в наличии поддержки протокола Bluetooth, поскольку он является особенностью нашей системы.

Здесь показаны лишь несколько функций, позволяющих понять, как всё происходит. В основном, они связаны с проверкой ключей, умножением скалярных величин, генерацией производных и подобными вещами.

На следующем слайде слева показан открытый кошелёк SideKick. По сути, мы создаём самый обычный кошелёк Monero, как если бы вы использовали какой-то другой новый кошелёк. Вы получаете файл с ключами, и на этом всё. Но вы также можете сделать резервную копию этого кошелька и импортировать её в Monorujo или десктоп-клиент. По итогу это будет самый обычный кошелёк Monero.

Итак, вы открываете это на SideKick и посредством Bluetooth подключаете к ней, в данном случае, Monorujo. Два устройства должны быть предварительно сопряжены —так работает Bluetooth. Затем на правом телефоне вы восстанавливаете кошелёк, который является кошельком SideKick. Делаете это точно так же, как делали бы это с Ledger. То есть, если представить, что левая сторона - это Ledger или Trezor, то процесс будет идентичным. Таким образом, справа у нас находятся все транзакции, подключение к интернету, файл кэша ваших транзакций, а ключи остаются исключительно на левой стороне. Сейчас мы каждый раз передаём ключ просмотра. Позже будет добавлена опция, позволяющая не делать этого. Но лично я никогда не слышал, чтобы кто-то этого не делал, потому что это вызывает какие-то затруднения. Возможно, это не идеальный вариант использования. Но, пожалуй, на этом и всё.

Конечно же, широко обсуждалась проблема, связанная с моделями угроз, возможностями проведения атак, и вначале было много негативных отзывов об использовании Bluetooth, EVO и подобных вещей. Вероятно, споры не утихли до сих пор. Bluetooth очень прост в использовании. Возможно, протокол небезопасен. Насколько я понимаю, вектор атаки Bluetooth нацелен на повреждённый стек Bluetooth в телефоне, с помощью которого злоумышленник мог бы получить права суперпользователя и совершить злонамеренные действия. Если это ваша модель угрозы, то не используйте Bluetooth, пользуйтесь бумажным кошельком.

SideKick построен таким образом, что использует то же шифрование ключей, что и Monorujo - такой же безумный пароль, что является отдельной темой. Но по сути он использует безопасное подписание на устройстве Android, при котором ключ совершенно недоступен, и находится внутри устройства. Мы создаём хэш, фактически подпись вашего пароля, который вы используете для кошелька, создаём подпись, хэшируем эту подпись с помощью медленной хэш-функции CryptoNight, чтобы в итоге получить 256-битный ключ, который используется в качестве пароля для вашего файла ключей.

Таким образом, если на ваше устройство не установлен граббер, позволяющий увидеть, что вы набираете, и у злоумышленника нет прав суперпользователя на этом устройстве и он не может получить доступ к безопасному подписанию для этого конкретного приложения, то ему придётся использовать метод перебора, который попросту ничего не даст. Если же он может сделать подобное, то мне уже ничего не поделать. Он просто сможет разгадать всё связанное с вашим кошельком, верно?

Пожалуй, если вкратце, то на этом всё. У нас есть два APK-файла, если вы захотите попробовать, как всё работает, что вчера уже и сделали несколько человек. Слева показан QR-код Monorujo. Возможно, нам следовало бы записать, куда ведут эти ссылки, а они ведут на monorujo.app и monoruyo.apk, а последняя - на sidekick.apk. Так что, переходите по ним, попробуйте.

Спасибо за внимание.
