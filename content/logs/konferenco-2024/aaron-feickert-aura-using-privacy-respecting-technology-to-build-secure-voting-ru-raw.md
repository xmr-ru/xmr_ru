---
title: "Аарон Фейкерт - Aura: использование приватных технологий для обеспечения безопасности голосования"
date: "2024-06-07"
categories:
  - "Стенограмма"
tags:
  - "MoneroKon 2024"
lead: "Monero Konferenco 2024 #MoneroKon2024 Прага"
pager: true
toc: false
sidebar: "right"
---

{{< youtube id="zB29jD9Qr2k" autoplay="false" >}}

---

_**Аннотация выступления**_

Электронное голосование - сложный процесс. Критически сложный! Существующие подходы к решению этой проблемы предполагают наличие множества компромиссов, связанных, например, с утечкой информации об избирателях или доверием к организаторам голосования с точки зрения добросовестности последних. Необходимо выработать такой способ проведения электронного голосования, при котором соблюдалась бы приватность избирателей, а также любой мог бы проверить правильность результатов, а фактор доверия к организаторам голосования и тем, кто осуществляет подсчёт голосов, сводился бы к минимуму.

В этой презентации будет говориться о протоколе голосования Aura, отвечающем всем этим параметрам. В этих целях Aura использует несколько технологий обеспечения приватности, в том числе некоторые из протоколов проведения приватных транзакций! Это высокоуровневый обзор принципов работы протокола, объясняющих практичность его использования.

Презентация будет понятна всем, даже тем, кто не обладает какими-либо специальными техническими познаниями.

_**Стенограмма выступления:**_

_**Аарон:**_ Итак, меня зовут Аарон. Ранее я уже выступал на тему безопасности и моделей безопасности, и немного говорил о том, какие доказательства безопасности протоколов в настоящее время мы используем в целом. Но сейчас я буду говорить о конкретном протоколе, который называется Aura. Речь пойдёт об использовании приватных технологий для обеспечения безопасности голосования.

Это результат нашей совместной работы с Арамом Дживаняном из проекта Firo, также представляющим Ереванский государственный университет. Сам я работаю руководителем отдела исследований в Cypher Stack, консалтинговой компании, занимающейся исследованиями и разработкой в сфере прикладной криптографии, но все исследования, связанные с протоколом Aura, проводились в рамках проекта Firo. Безусловно, всё сказанное будет носить информативный характер, и если вы воспользуетесь нашим протоколом при проведении выборов, и что-то вдруг пойдёт не так, как хотелось бы, вы не сможете нам что-либо предъявить.

Итак, во-первых, процесс голосования по-настоящему сложен. Он настолько сложен, что я добавил на слайд эту иконку, наглядно демонстрирующую, насколько всё сложно. Он сложен, поскольку разные типы выборов предполагают наличие совершенно разных требований, как в плане доверия, так и в плане самого процесса и того, что вы хотите получить на выходе. Например, если вы проводите голосование в рамках какого-то комитета, где все знают друг друга, и хотите, чтобы голосование было тайным, то, вероятно, всё можно будет организовать без каких-либо затруднений. Такие голосования проводятся постоянно. Но если вы захотите провести тайное голосование, например, при выборах в городской совет, всё тут же усложнится, поскольку это уже будут другие требования к доверию и другие принципы. В свою очередь, это будет отличаться от выборов президента или премьер-министра, что, в свою очередь, будет отличаться от проведения электронного голосования с использованием блокчейн-технологии.

И в случае с цифровым голосованием всё гораздо, возможно, вдвое сложнее. Поэтому здесь я ставлю два маленьких черепа с перекрещенными костями. Цифровое голосование создаёт новые проблемы, поскольку вы переходите из физического мира, где, на мой взгляд, в каком-то смысле проблема голосования была решена не до конца, но всё же есть определенные аспекты, которые хорошо понятны. Так, например, там мы имеем дело с физическими личностями и выработанными безопасными методами голосования, подсчёта голосов и подведения итогов. Опять же, эти методы могут быть не до конца продуманными, но, по крайней мере, они достаточно хорошо понятны. Но при цифровом голосовании всё меняется. Во многих случаях не получится применить единый и понятный всем метод цифровой идентификации. Возникают вопросы, связанные с доверием и способами проведения выборов с использованием бюллетеней. Необходимо понять, как сделать такие выборы тайными, как правильно подсчитать голоса и проверить, что подсчёт был действительно верным.

Что ж, посмотрим, что может дать нам цифровая система голосования. Какие задачи она может решить? И в данном случае сфокусируемся на четырёх основных задачах.

И первая из них - приватность бюллетеня. То есть, если кто-то заглянет в такой бюллетень, сохранённый, скажем, в каком-нибудь цифровом реестре, и блокчейн в данном случае будет удачным примером, то этот кто-то не должен иметь возможности, заглянув в бюллетень, какие кандидаты были в нём отмечены. Ведь это даёт очень много информации и в процессе голосования может повлиять на результаты.

Вторая задача - приватность избирателя. Она отличается от приватности бюллетеней. Приватность бюллетеня подразумевает, что выбор, отмеченный в бюллетене, не будет виден всем без исключения. Приватность же избирателя означает, что ни у кого не должно быть возможности, заглянув в бюллетень, сохранённый в реестре, узнать, кто из избирателей проголосовал с его помощью. В этом состоит идея тайного голосования. Вы не должны иметь возможности узнать, кто именно проголосовал.

Третья задача - возможность проверки. Поскольку вся эта информация заносится в какой-то реестр, процедуры подсчёта и подведения итогов проводятся так, как они, собственно, и проводятся. В конце концов, каждый человек, независимо от того, участвовал он в выборах или нет, должен иметь возможность криптографически - именно поэтому мы и говорим об этом на конференции, посвящённой криптографии - должен иметь возможность доказать, что результаты действительны, что все, кто должен был проголосовать на выборах, имели такую возможность, и что все подсчитанные голоса соответствуют секретным бюллетеням.

И наконец, нам нужно свести к минимуму фактор доверия. И это самое главное. Если у чиновников или у тех, кто занимается подсчётом голосов, или у организаторов выборов будет какой-то злой умысел - в может, он всегда у них есть, кто знает? - у них не должно быть возможности причинить значимого ущерба. Вероятно, в этом плане мы сможем свести к минимуму так называемый радиус взрыва. Но мы однозначно не можем излишне полагаться на честность таких чиновников.

Как уже было сказано, цифровые реестры отлично подходят для всего этого. Распределённые публичные реестры, каковым и является блокчейн, как правило, являются очень хорошим средством для решения наших задач. Благодаря криптографии и сетевому эффекту, блокчейны довольно устойчивы к взлому и нередко обладают очень высокой степенью доступности. Именно поэтому они так часто используются при реализации протоколов цифровых активов.

Общая идея сводится к тому, что избиратель создаёт свой цифровой бюллетень, делает это либо на избирательном участке, либо дома - в зависимости от требований выборов, и отправляет его в сеть. И если бюллетень действителен, что необходимо проверить, он добавляется в публичный реестр. И в самом конце выборов бюллетени каким-то образом, на данный момент волшебным образом подсчитываются. Но как привести всё это в соответствие нашим четырём задачам? Вот один из примеров.

Один из способов - воспользоваться некоторыми из методов, которые мы уже применяем в случае с приватными протоколами цифровых активов, и перенести их в область бюллетеней, выборов и голосования. То есть, многие из тех криптографических примитивов и конструкций, на которых я не стану останавливаться подробно, могут быть в той или иной степени перенесены. Поэтому рассмотрим некоторые аспекты протоколов проведения приватных транзакций и посмотрим, как они могут соотноситься с протоколами голосования.

Итак, в протоколах цифровых активов, как правило, транзакция подписывается, чтобы показать, что она авторизована. Подобным образом в протоколе голосования бюллетени подписываются, чтобы показать, что они авторизованы избирателем.

В приватных протоколах цифровых активов подписи часто неоднозначны, и вы не всегда можете определить подписанта, но при этом знаете, что сама подпись действительна. То же самое можно реализовать и в рамках протокола цифрового голосования, где подписи будут неоднозначными, что обеспечит приватность избирателя.

В приватных протоколах цифровых активов суммы и другие детали часто зашифрованы. И они зашифрованы таким образом, что их можно проверить на наличие таких свойств, как сбалансированность транзакции, что не позволяет создавать деньги из воздуха. В протоколе цифрового голосования выбор, то есть то, какие кандидаты или варианты будут выбраны в бюллетене, должны быть зашифрованы подобным образом, чтобы мы могли всё обосновать.

В протоколе цифровых активов нам, конечно же, нужно, чтобы транзакции можно было проверить, чтобы показать, что ничего не произошло, что они соответствуют правилам протокола, какими бы они ни были. То же самое мы хотим видеть и в случае с протоколом цифрового голосования. Нам нужно, чтобы бюллетени можно было проверить и убедиться в том, что выборы прошли честно.

И наконец, в случае с протоколами цифровых активов мы хотим исключить возможность двойной траты. То есть если я попытаюсь потратить средства в одной транзакции, а затем ещё раз в другой, такая двойная трата будет отклонена. В противном случае деньги будут создаваться из воздуха. Аналогично, мы хотим исключить возможность двойного голосования. Но к этому я вернусь позже.

Aura - это один из вариантов решения всех этих задач. Существует множество различных проектов, многие из которых предполагают наличие множества компромиссов. Но Aura - это проект, который мы разработали вместе с моим соавтором, и который представляет собой приватный протокол цифрового голосования, использующий многие из тех методов, которые применяются в случае с цифровыми активами, о которых мы говорили, и которые, по нашему мнению, отвечают поставленным задачам.

Итак, в процессе выборов участвуют несколько игроков. Первым является организатор. Это организация, которая организует выборы, определяет, что будет поставлено на голосование, какие будут варианты, и кто будет подсчитывать голоса в конце. Часто для подсчёта требуется сразу несколько лиц, чтобы, если одно из них окажется недобросовестным, оно не смогло бы причинить значительного ущерба. Также такие организаторы определяют, кто из избирателей допускается к выборам. Разумеется, всё это может сильно отличаться в зависимости от того, о каких выборах идёт речь.

Далее следует избиратель, который будет голосовать на выборах. Подсчёт бюллетеней будет осуществляться одним или группой лиц. Это позволит получить результаты выборов. И наконец, верификатором может быть кто угодно. Зачастую для этого привлекается любой человек, независимо от того, участвовал он в выборах или нет - любой наблюдатель или участник сети. Такой человек должен быть в состоянии проверить достоверность результатов выборов.

И сначала рассмотрим свойство, которое уже упоминалось - приватность бюллетеня. Оно подразумевает, что никто, заглянув в бюллетень, сохранённый в реестре, не сможет узнать, какой из вариантов выбрал избиратель. Я обещал, что не будет никакой математики, но всё же здесь мы используем криптографический термин - шифрование Эль-Гамаля. Существует множество различных способов шифрования данных, один из которых называется шифрованием Эль-Гамаля. Этот способ повсеместно используется отчасти потому, что он имеет очень специфическую структуру, позволяющую обосновать то, что шифруется. Итак, чтобы зашифровать выбранный им в бюллетене вариант, избиратель использует шифрование Эль-Гамаля. И это делается таким образом, что только те, кто занимается подсчётом голосов, впоследствии смогут расшифровать его выбор. И поговорим немного о том, что это означает.

А это означает следующее: в моём примере на выборах нужно проголосовать за Элис, Боба, Чарли, Дану или Еву. Допустим, избиратель хочет выбрать Боба, но не хочет при этом просто отметить Боба в своём бюллетене и сохранить бюллетень в реестре. Это тут же нарушит приватность голосования. Поэтому избиратель шифрует выбор Элис, который будет отрицательным, то есть, "нет", или в случае с шифрованием Эль-Гамаля нулевым. И никто в этом блобе, никто, кроме тех, кто подсчитывает голоса, не сможет ничего расшифровать. Для Боба шифруется положительный выбор, то есть, "да". Для Чарли, Даны и Евы - "нет". Но для стороннего наблюдателя всё это будет выглядеть как некий закрытый блоб.

Но нам нужно убедиться в том, что голосующий не выбрал больше вариантов, чем разрешено. Если я просто выберу для всех "да" или так же для всех "нет", это может оказаться недопустимым в случае с конкретными выборами. Поэтому необходимо убедиться в том, что избиратель не выбрал больше вариантов, чем допускается, что он действительно зашифровал бюллетень так, чтобы при подсчёте его можно было расшифровать, а также, что он не взял и просто вбросил в блокчейн какой-то случайный нонс.

Поэтому мы фактически используем два отдельных доказательства с нулевым разглашением, одно из которых доказывает, что бюллетень точно содержит разрешённое количество вариантов. В нашем примере это количество равно единице - в данном случае это Боб. Но на других выборах может быть разрешено голосовать сразу за нескольких кандидатов. Всё зависит от правил. Но как бы то ни было, мы можем показать, что бюллетень содержит допустимое количество вариантов - не больше и не меньше. Также с помощью доказательства с нулевым разглашением мы можем доказать, что бюллетень зашифрован правильно и его можно будет расшифровать при подсчёте. И оба эти доказательства возможны благодаря очень структурированному методу шифрования Эль-Гамаля. И это замечательно, поскольку недействительный бюллетень можно исключить из реестра ещё до того, как он туда попадёт, и любой верификатор может проверить эти доказательства и продемонстрировать, что все необходимые свойства поддерживаются.

Но как при этом обеспечить приватность избирателей? То есть, мы уже не можем увидеть, что написано в бюллетене, хотя выбор при этом действителен, но как нам узнать, что бюллетень был подан допущенным к выборам избирателем, но при этом не знать, кто этот избиратель? Опять же, чтобы гарантировать, что никто не сможет узнать, кто именно проголосовал, мы можем использовать некоторые из методов, применяемых приватными протоколами цифровых активов. Для этого каждый бюллетень подписывается с помощью чего-то навроде связываемых кольцевых подписей, используемых в Monero и других подобных протоколах.

Такая подпись демонстрирует сразу несколько вещей. Во-первых, она демонстрирует, что подписант находится в списке допущенных избирателей, который, как вы помните, организаторы составили в самом начале выборов. В них находятся все избиратели, которым разрешено голосовать на этих выборах, и мы можем показать, что подписавший бюллетень находится в таком списке. Мы также можем продемонстрировать, что подписант действительно отдал свой голос, и что с ним не было произведено никаких манипуляций. Также, воспользовавшись свойством связности некоторых из этих кольцевых подписей и связанных с ними конструкций и криптографии, мы можем показать, что избиратель не подавал бюллетень ранее, избежав тем самым двойного голосования. И, что немаловажно, благодаря всем этим свойствам подписи и бюллетеня невозможно определить, кто из избирателей на самом деле его подписал. Таким образом, мы решаем множество проблем. И, опять же, как уже было сказано, все это очень похоже на то, что обеспечивают приватные протоколы цифровых активов.

Как и в случае с предыдущими примерами, благодаря таким подписям недействительный бюллетень может быть немедленно отклонён реестром. И, как и раньше, любой верификатор может всё проверить после выборов, чтобы убедиться в том, что все эти свойства сохраняются.

Теперь самое интересное - процесс подсчёта голосов. До сих пор мы говорили просто о подсчёте бюллетеней. Но мы хотим убедиться в том, что лица, осуществляющие подсчёт, смогут точно подсчитать бюллетени и выдать точный результат, ничего при этом не узнав об отдельных бюллетенях. Никто, заглянув в бюллетень, не должен быть в состоянии определить, кто его подписал или что в нём указано. Но, как уже было сказано, бюллетени шифруются так, что те, кто производит подсчёт, могут их расшифровать. Так как же тешить эту проблему?

После выборов лица, отвечающие за подсчёт результатов, должны пересчитать бюллетени. Однако, поскольку они не должны увидеть выбор в каждом конкретном бюллетене, они делают следующее.

Первое, что они делают - и я взял это в кавычки, - они "складывают" зашифрованные бюллетени. А поскольку нами используется хорошо структурированное шифрование Эль-Гамаля, те, кто отвечает за подсчёт, могут буквально взять из каждого бюллетеня все зашифрованные данные, связанные с Элис, и сложить их криптографическим способом. Затем сделать то же самое с данными, связанными с Бобом, и так далее для каждого варианта. А затем они все вместе - а как я уже говорил, часто бывает так, что подсчёт осуществляется несколькими лицами, группой лиц, чтобы одно из этих лиц не могло причинить значимого ущерба, - затем они совместно расшифровывают только сумму всех этих бюллетеней. Таким образом, суммируются все бюллетени, отданные за Элис, Боба, Чарли и так далее. И наконец, после совместной расшифровки можно опубликовать общее количество голосов, отданных за каждый вариант - общее количество голосов за Элис, за Боба, за Чарли и так далее. Я упомянул этот аспект совместной работы, поскольку мы используем особый вид совместной и проверяемой расшифровки.

Этот механизм работает потому, что каждое отдельное лицо, осуществляющее подсчёт, не обладает полным ключом, необходимым для расшифровки бюллетеней. У всех них есть только часть ключа. И для этого нами используется особый вид пороговой верифицируемой схемы. Поэтому ни одно отдельно взятое лицо не сможет расшифровать ничего в одиночку, но сможет сделать это в составе группы, что в идеале сводит доверие к минимуму, поскольку для того, чтобы что-то пошло не так, необходимо, чтобы все лица, отвечающие за подсчёт, оказались злоумышленниками.

И, конечно же, как и раньше, такая совместная расшифровка также подразумевает наличие доказательство того, что все полученные суммы верны. Таким образом, любой сможет убедиться, что расшифровка была произведена честно.

Я также упомянул о минимизации фактора доверия. Как было сказано, мы хотим уменьшить так называемый радиус взрыва, возможного вследствие сговора или наличия злого умысла у организаторов или лиц, ответственных за подсчёт. Напомню, что организаторы определяют выборы и выбирают тех, кто будет подсчитывать голоса, а также выбирают допущенных избирателей. И, как было сказано, лица, осуществляющие подсчёт, делают это совместно - совместно вычисляют суммы и затем расшифровывают результаты выборов, чтобы затем опубликовать их.

Итак, несколько комментариев, связанных с тем, как мы можем свести фактор доверия к минимуму. Со стороны организатора Aura работает так, что, хотя организатор и может выбирать допущенных избирателей, он не контролирует ключи, которые избиратели используют для вычисления, подписания и публикации своих бюллетеней. Поэтому после организации выборов он не может сделать ничего серьёзного. Кроме того, все операции, используемые при организации выборов, поддаются проверке. Поэтому у организатора очень мало возможностей, чтобы обмануть людей.

Как уже говорилось, отдельное лицо, осуществляющее подсчёт, не обладает полным ключом для расшифровки бюллетеня, и поэтому не может самостоятельно произвести расшифровку. Группа таких лиц, если они вступят в сговор, может расшифровать отдельные бюллетени, что плохо - они смогут увидеть результаты и выбор, сделанный избирателями, но они всё равно не смогут определить, кто из избирателей проголосовал. Так что радиус взрыва вокруг лиц, ведущих подсчёт голосов, вроде бы есть, но в идеале он невелик.

Есть и другие хитрости, которые может задействовать протокол, в зависимости от того, какие свойства будут нужны. Первая - это исключение доверительных настроек. Многие другие криптографические схемы исподволь или явно требуют их наличия. В случае с Aura это не так. Все криптографические конструкции вычисляются и строятся открыто и верифицируемо. И это здорово.

Устойчивость к принуждению - очень тонкое свойство. Ведь нам не нужно, чтобы у кого-то были стимулы принуждать избирателя голосовать определённым образом или пытаться подкупить его, чтобы тот проголосовал, как нужно. В схемах цифрового голосования этого добиться очень и очень сложно. Принуждение и подкуп могут произойти, если принуждающая или подкупающая сторона скажет: "Проголосуй так, как я того требую или за что я плачу тебе, а потом покажи мне, - а так как мы имеем дело с криптографией, - докажи мне, что ты действительно проголосовал так, как нужно мне". Этого очень трудно избежать.

Уже существует версия Aura, которую можно построить путём внесения модификаций, и минимизировать эти риски, позволяя избирателю голосовать несколько раз. Да, было сказано, что мы хотим избежать возможности повторного голосования. Но всё же можно модифицировать Aura таким образом, чтобы избиратель смог проголосовать несколько раз, но таким образом, чтобы при подсчёте голосов учитывался только один, самый последний голос. В идеале это помогает хоть немного снизить риск принуждения или подкупа, потому что если кто-то заплатит вам за то, чтобы вы проголосовали так, как он того хочет, и вы докажете, что сделали это, вы сможете затем взять и тайно проголосовать так, как на самом деле хотите именно вы.

Это не идеальная схема, и есть разные способы добиться или хотя бы попытаться добиться устойчивости к принуждению. Но Aura предлагает тот, который, на мой взгляд, является довольно неплохим компромиссом.

Ещё один способ - настройка ключа для подсчёта голосов. Я уже упоминал, что каждое лицо, осуществляющее такой подсчёт, хранит только часть ключа, необходимого для действительной расшифровки. Но мы также можем сделать это очень безопасным и проверяемым способом. Если этого не сделать, неясно, каковы могут быть последствия расшифровки слишком малым количеством лиц. Однако мы можем реализовать очень хорошую, надёжную настройку для подсчёта или для ключей.

Наконец, я вскользь упомянул, что не на всех выборах будут действовать те же правила, что и на тех, которые мы взяли в качестве примера, когда есть несколько кандидатов и вы можете проголосовать только за одного. Оказывается, можно немного модифицировать правила так, чтобы поддерживалось как минимальное, так и максимальное количество вариантов выбора. Так, возможно наличие нескольких кандидатов, и вы должны проголосовать как минимум за трёх из пяти, например, но не более. Мы можем построить Aura таким образом, чтобы это можно было сделать проверяемым способом. Так что наш протокол обеспечивает значительную гибкость.

Я многого не рассказал. Я совсем не говорил о деталях протокола. Но едва ли вы бы захотели, чтобы я делал это здесь. Тем не менее, уже есть препринт нашей работы, выложенный в архиве ia.cr, а также есть репозиторий со всеми техническими выкладками для препринта. Эти слайды также будут выложены на GitHub после мероприятия. Так что, если захотите, вы сможете просмотреть их ещё раз. Также тут указана моя электронная почта. Я буду рад ответить на любые вопросы. Спасибо.
