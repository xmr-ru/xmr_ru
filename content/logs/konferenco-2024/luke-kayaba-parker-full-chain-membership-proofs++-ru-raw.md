---
title: "Люк 'Kayaba' Паркер - Доказательства участия на основе полного блокчейна++"
date: "2024-06-07"
categories:
  - "Стенограмма"
tags:
  - "MoneroKon 2024"
lead: "Monero Konferenco 2024 #MoneroKon2024 Прага"
pager: true
toc: false
sidebar: "right"
---

{{< youtube id="6OrzSZgF6hg" autoplay="false" >}}

---

_**Аннотация выступления**_

В этом докладе речь пойдет о недавно обсуждавшемся протоколе доказательства участия на основе полного блокчейна++, развивающим доказательство участия на основе полного блокчейна в качестве обновления, независящим от Seraphis и связанной с ним миграцией.

_**Стенограмма выступления:**_

_**Люк:**_ Всем привет! Это снова я, как и в прошлом году. И сегодня я здесь, чтобы рассказать о "доказательствах участия на основе полного блокчейна плюс-плюс".

Я всегда начинаю свои слайды с небольшого вступления. Меня зовут Люк Паркер. Онлайн я также известен как Kayaba или kayabaNerve, если вы предпочитаете IRC. Я являюсь разработчиком доказательств участия на основе полного блокчейна плюс-плюс, а также Serai, децентрализованной биржи Monero. Также я являюсь членом комитета MAGIC Monero Fund. Если вы хотите пожертвовать на развитие Monero, проживаете в США и хотите получить налоговый вычет, MAGIC - это благотворительная организация, пожертвовав в которую, вы можете сделать это. Так что это действительно хорошая организация. Мне также посчастливилось стать трёхкратным участником MoneroKon. Посмотрим, насколько удачно всё получится в этот раз. И ещё один забавный факт - у меня очень хорошо получается придумывать названия. Здесь я вне конкуренции.

Итак, доказательства участия на основе полного блокчейна. Данные доказательства было предложено реализовать в рамках очередного обновления протокола Monero. Они должны были заменить собой кольца и устранить практически все проблемы, связанные с ними. Предложение обсуждалось в течение многих лет. Даже не знаю, насколько каждый из вас знаком с ним, но это было связано с так называемыми атаками EAE в экосистеме Monero. Существует также атака EABE. Просто добавляется ещё одна буква, но это только наполовину шутка. В сообществе Zcash она также известна под названием "атака внешнего наблюдателя", а ещё её называют атакой "помеченной пылью". Но, по сути, всё сводится к тому, что если я отправлю на ваш адрес 10 экземпляров одной Monero, а потом вы потратите, то есть, совершите транзакцию с 10 входами, в каждом из колец при 16 участниках каждому входу будет соответствовать помеченный мной выход, и я смогу с некоторой определённостью утверждать, что вы наверняка объединяете экземпляры одной Monero, которые я вам и отправил. И это ужасно, поскольку вы объединяете не только 10 входов, но и сообщаете, что у вас в принципе есть эти 10 входов. При этом вовсе не обязательно, чтобы их было 10. Даже при наличии всего двух выходов схема работает не менее разрушительно. Кроме того, существуют и другие примеры с одним выходом или одним входом.

Но перейдём к самим доказательствам участия на основе полного блокчейна. Их реализация стала целью проекта Monero на несколько лет. Zcash решил проблему с помощью доказательств zk-SNARKs. В частности, они использовали систему доказательств Pinocchio, а затем перешли к Sapling. Обе эти системы требовали доверительных настроек. В итоге в качестве платёжного протокола ими был принят Orchard, а в качестве системы доказательств - Halo2, что окончательно устранило необходимость в доверительных настройках. Я хотел бы подчеркнуть, что мы пытались сделать это в течение многих лет, но поскольку мы никак не хотели использовать доверительную систему, у нас было не так много вариантов. Поэтому нам пришлось приложить много усилий, чтобы сделать что-то, что не требовало бы использования доверительной системы, но при работало бы и было бы жизнеспособным.

В итоге мы остановились на доказательствах Bulletproofs, которые уже использовались Monero в качестве доказательств диапазона. И это даже забавно, поскольку они появились семь лет назад, и вот мы снова предлагаем использовать их сегодня. Это свидетельствует лишь о качестве Bulletproofs. И в прошлом году на MoneroKon, когда я объявил о работе над доказательствами участия на основе полного блокчейна, предполагалось, что они будут реализованы в рамках Seraphis. Так что это моё выступление будет посвящено тому, что было сделано за прошедший год.

Итак, мы перешли от доказательств участия на основе полного блокчейна к доказательствам участия на основе полного блокчейна плюс-плюс - регистрация торговой марки в процессе. Это доказательства участия на основе полного блокчейна плюс авторизация трат, плюс связываемость. Я же говорил, что у меня отлично получается придумывать названия. Так что это не замена доказательств участия, которые мы реализуются вместе с Seraphis, или которые предлагалось реализовать с Seraphis, а замена кольцевой подписи CLSAG, которая сейчас используется Monero. То есть, вместо того чтобы заменить компонент Seraphis в будущем, он заменяет часть протокола Monero уже сегодня вне обновления Seraphis. Когда я изначально опубликовал своё предложение, речь шла именно об этом - реализация  доказательств участия на основе полного блокчейна Monero, не дожидаясь обновления Seraphis. Так что обновление Seraphis никак нам не мешает, а наше предложение, по сути, реализуется само по себе. И, то множество функций, которое вы, вероятно, ожидали от Seraphis, и о которых я расскажу чуть позже, теперь может быть реализовано с помощью данного предложения. И самое главное - оно не требует какой-либо миграции. В рамках обновления Seraphis мы планировали ввести новые адреса, и, к сожалению, это также приводило к аннулированию старых адресов. Доказательства участия на основе полного блокчейна плюс-плюс сохраняют все существующие адреса. При этом мы получаем практически весь функционал, о котором мы будем говорить сегодня, несмотря на то, что старые адреса существуют уже много лет.

Итак, особенности. Доказательства участия на основе полного блокчейна плюс-плюс фактически объединяют все наши приватные пулы. Сейчас в Monero существует несколько различных приватных пулов. Большинство из вас, вероятно, никогда не замечали или даже не думали об этом, поскольку у нас есть оригинальные выходы CryptoNote, раскрывающие сумму, не обеспечивающие приватности суммы, привязанные к собственному приватному пулу. А также у нас есть новые выходы Monero, скрывающие суммы, и у них свой приватный пул. И в рамках нашего предложения мы наконец-то объединим их, создав единый приватный пул всех выходов, имеющихся в блокчейне Monero.

Сохраняется поддержка аппаратных кошельков. Я указал это свойство как "пригодность". Да, кому-то придётся обновлять каждый из наших аппаратных кошельков в соответствии с новым программным обеспечением. Но аппаратные кошельки по-прежнему будут поддерживаться. Мы не скажем: "Извините, но теперь, чтобы совершить транзакцию, вам нужен i7 с восемью ядрами". К счастью, этого не будет.

Также наши доказательства позволяют строить цепочки транзакций, а вместе с ними и некоторые структуры второго уровня. Это одна из функций, которую мы с нетерпением ждали от Seraphis, - возможность подписать транзакцию, содержащую выходы, которые ещё не были сохранены в блокчейне. Это может иметь значение, если, допустим, я со своим другом Джеффом захотим купить дом вместе, этакий крутой дом, в котором будем заниматься всеми разработками Monero - а почему бы и нет! Но мне бы не хотелось просто переводить половину денег за дом. Дом стоит очень дорого. И я могу сказать, что выделю деньги на дом, но только если сначала он совершит свою транзакцию. То есть, я могу сделать свою транзакцию зависимой от его транзакции. Таким образом, если абстрагироваться от моего неудачного примера, построение цепочки транзакций просто позволяет указывать требования к транзакции, чтобы она действительно состоялась, и это позволяет реализовать некоторые протоколы.

Это также позволяет достичь опережающей приватности вновь созданного вывода. Мы всё ещё обсуждаем, что именно подразумевается под этим новым определением. Возможно, оно будет внедрено в первоначально предложенном обновлении доказательств участия на основе полного блокчейна плюс-плюс, а возможно, немного позже, в зависимости от сроков разработки. Но опережающая приватность является ещё одним из новых свойств доказательств. Опережающая приватность означает, что в тот момент, когда появятся квантовые компьютеры, они смогут просканировать всю сеть Monero и выяснить, какие средства были потрачены в каждой конкретной транзакции. Но при наличии опережающей приватности квантовый компьютер не сможет сделать этого. Таким образом, даже приватность Monero сохранится и в будущем.

Последняя функция, о которой я расскажу, - ключи просмотра исходящих транзакций. Итак, что это такое - сейчас, если у вас есть кошелёк, предназначенный только для просмотра, вы можете видеть все входящие транзакции, но не можете увидеть, потратили вы свои средства или нет, и поэтому не можете рассчитать баланс. Вы можете вычислить только полученную сумму. Ключи просмотра исходящих транзакций позволяют увидеть, когда был потрачен выход, а соответственно, можете точно подсчитать баланс. Это значительно упрощает аудит таких организаций, как благотворительные фонды, аудит публичных кошельков, общественных фондов и так далее.

Очевидно, обновление любого протокола подразумевает большой объём работы. Я как бы разбил предполагаемый фронт работ на два слайда, чтобы показать, как продвигаются исследования, и как движется разработка. Что касается исследований, у нас уже есть документ на 20 с лишним страниц, в котором подробно описана вся работа, связанная с доказательством, то, как оно будет интегрировано в Monero, и так далее, и тому подобное, и этот документ содержит, цитирую: "спецификацию схемы". В предыдущем выступлении вкратце упоминались схемы, но при этом подробно они не рассматривались. Схема - это, по сути, программа. Так что в данном случае у нас есть программа, которая говорит: мой выход - это один из выходов в блокчейне Monero. И мы создаём доказательство с нулевым разглашением, подтверждающее, что программа была успешно выполнена. То есть мы доказываем, что данный выход является одним из выходов в блокчейне, но при этом не раскрываем, каким именно. То есть документ содержит точную программу, точную схему.

Обобщённые доказательства Bulletproofs. Вышеупомянутое обобщение доказательств Bulletproofs, которое мы используем и для которого были предложены доказательства безопасности. Технически, они не являются обобщёнными доказательствами Bulletproofs, безопасность которых была доказана. В оригинальном документе была упущена некоторая функция, и то, что мы в итоге доказали, уже содержало эту функцию. Так что в итоге всё получилось даже лучше, чем ожидалось. И результат также попал под определение обобщённых доказательств Bulletproofs. Так что если нужна конкретика, то следует выйти за пределы доказательства участия, подтверждающего, что выход является одним из выходов в блокчейне. В данном случае следует говорить: да, я владею этим выходом, я хочу потратить его в этой транзакции, это его образ ключа, и это действительный образ ключа. Вот к чему относятся авторизация трат и связываемость. Для этого мы фактически используем существующие доказательства. Мы не делаем ничего нового. То есть мы не выдвигаем никаких предположений. По сути, мы используем текущие доказательства Bulletproofs++, применяемые сегодня в Monero, а также обобщённые протоколы Шнорра, которые появились ещё в 2007 году - обобщённые подписи Шнорра. Как же много сегодня у нас обобщений.

Что касается дальнейших шагов, хочу сказать, что мы активно сотрудничаем с исследователями. Одна из областей исследования - повышение эффективности с помощью делителей эллиптических кривых. Идея была предложена Лиамом Иганом, который только что выступал. Так что мы активно работаем с исследователями, проводим широкий анализ и пытаемся создать больше доказательств.

Для всего этого нами был успешно организован фонд. Учитывая недавний рост Monero, полагаю, мы собрали, чуть больше $220 000. Это покрывает затраты на все необходимые доказательства безопасности, формальную проверку и аудит.

Что касается разработки, используемое нами обобщённое доказательство Bulletproofs, базовое доказательство с нулевым разглашением, уже реализовано. Реализована и сама схема. Работа над Bulletproofs++ и обобщённым протоколом Шнорра в значительной степени выполнена. В целом, мы планируем получить полный набор библиотек в течение следующих четырёх месяцев, когда дело дойдёт до аудита. А затем, через несколько месяцев, мы планируем опубликовать пул-реквест на интеграцию. А затем, как я надеюсь, примерно через шесть месяцев после этого произойдёт активация в основной сети. То есть, пул-реквест рассматривается несколько месяцев, несколько месяцев все скачивают обновления узлов, а затем, наконец, всё активируется. Лично я надеюсь, что это произойдёт через год и три месяца.

Что касается производительности, то, как я уже говорил в самом начале, это одна из главных проблем. Именно поэтому многие проекты используют доверительные настройки. Доверительные настройки позволяют добиться большей производительности и сделать что-то жизнеспособное. На последней MoneroKon речь шла о 100 миллисекундах на группу из 10 для 777 миллионов выходов. Теперь эта цифра значительно изменилась. Теперь это 12 миллисекунд, что примерно в восемь раз быстрее, для 2,19 миллиарда выходов, что примерно в три раза больше. Ожидается, что и это будет улучшено. Сейчас для реализации мы используем обобщённые арифметические библиотеки. Но если мы внедрим специализированные арифметические библиотеки, это станет явным преимуществом, в том числе с точки зрения затрат.

И ещё один момент, который хотелось бы отметить - производительность зависит не только от доказательств с нулевым разглашением. Сейчас всякий раз, когда мы в Monero проверяем кольцевую подпись, нам приходится делать множество случайных считываний базы данных, поскольку нам необходимо получить информацию о каждом выходе, который может быть потрачен. Одно из преимуществ доказательств участия на основе полного блокчейна состоит в том, что нам достаточно хранить в памяти 32-байтовый хэш для каждого блока. И это всё, что нам нужно для проверки доказательства. Так что доказательство не только намного меньше, простите, доказательство намного больше, но оно значительно сжалось по сравнению с тем, что было, и позволяет избежать лишних и необходимых сейчас считываний базы данных. Так что это также является определённым преимуществом. Хотя да, пока что, эти доказательства затратней, чем текущие кольцевые подписи.

Что касается дальнейших шагов, мы планируем просто двигаться по тому же пути, что и сейчас. То есть, заниматься разработкой, поддерживать связь с исследователями и аудиторами. Мы совсем недавно связывались с несколькими из них, работая над решением очередной задачи. И мы будем обращаться к ним снова в будущем и просто поддерживать отношения. Кроме того, мы планируем привлечь в проект Monero больше разработчиков. Об этом много говорилось, и мне кажется, что большинство разработчиков Monero в курсе, чем мы занимаемся. Но когда придёт время для рассмотрения пул-реквеста и завершения интеграции, я уверен, что все начнут комментировать и пытаться высказать своё мнение. Так что мы просто хотим уже сейчас ознакомить разработчиков со всем необходимым, чтобы потом не было никаких задержек.

Вопросы?
