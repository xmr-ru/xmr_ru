---
title: "Люк Паркер - Доказательства участия на базе полного блокчейна как решение одной из проблем обеспечения приватности в Monero"
date: "2023-06-23"
categories:
  - "Стенограмма"
tags:
  - "Monerotopia 2022"
lead: "Monero Konferenco 2023 #MoneroKon2023 Прага - День 1"
pager: true
toc: false
sidebar: "right"
---

{{< youtube id="XPKvFwe8d1M" autoplay="false" >}}

---

_**Люк Паркер:**_ Большое спасибо. Очень рад наконец-то выступить здесь. Рад поделиться своими слайдами, пока нахожусь на сцене. И сегодня я расскажу о доказательствах участия на базе полного блокчейна как решении одной из последних проблем обеспечения приватности Monero.

Итак, начнём с того, кто я такой. Имею обыкновение коротко представляться перед всеми своими выступлениями. Люк Паркер, Kayaba или kayabaNerve. Если вы встретитесь со мной в сети, то, скорее всего, под одним из этих имен. Я являюсь разработчиком и неформальный криптографом. Я не пишу статьи, я не пишу доказательства безопасности. Но я занимаюсь реализацией различных версий и делаю всё возможное, чтобы они работали как можно быстрее.

Постараюсь сделать так, чтобы это не повторилось. Также я являюсь ведущим разработчиком Serai, децентрализованной биржи, которая будет поддерживать Bitcoin, Ethereum и Monero. Её запуск вы можете ожидать в ближайшем будущем.

Я являюсь членом комитета фонда MAGIC Monero. MAGIC - это благотворительная организация 501c3, а целью комитета фонда Monero Fund является финансирование исследований и разработок Monero. Пожертвования в этот фонд не облагаются налогом в США, так что я всегда ратую за его поддержку.

Наконец, я слуга сообщества Monero, поэтому сегодня я в таком наряде.

Итак, чтобы ввести всех в курс дела, кратко о том, что такое доказательства участия на базе полного блокчейна. доказательства участия на базе полного блокчейна - это замена кольцевых подписей. Вместо 16 выходов они используют весь блокчейн в качестве одного из возможных выходов. Соответственно, технически они исключают, пусть и не полностью, но по большей части возможность статистического анализа входов.

Джастин Берман, один из товарищей и таких же слуг сообщества Monero - это просто дружеское упоминание, никаких совместных фотографий, к сожалению, нет - сегодня выступит с отличной презентацией по приватности токенов. Ну, технически его выступление посвящено лёгким кошелькам, но в его рамках он будет говорить и о приватности при использовании модели ложных выходов. Так что, рекомендую послушать его выступление.

Как бы то ни было, доказательства участия на базе полного блокчейна позволяют решить проблему EAE и EABE анализа, наблюдения, о которой говорилось в одном из эпизодов Breaking Monero. Они также решат проблемы с некоторыми другими типами атаки, например атаки с использованием  помеченной пыли.

Доказательства участия на базе полного блокчейна предлагаются как часть Seraphis, следующего обновления протокола Monero, а не как его замена. Так что не стоит думать, будто мы пытаемся избавиться от Seraphis. Нет, это часть Seraphis.

Также эти доказательства позволят нам избавиться от необходимости в алгоритме выбора ложных выходов. И это один из любимых нами и Джастином аспектов, поскольку эти алгоритмы - наша общая боль. Мы потратили много времени на их изучение, на работу над ними и продолжаем вносить исправления по сей день. А если мы перейдем к использованию доказательств участия на базе полного блокчейна, нам более не придется уделять им какого-либо внимания, что очень порадует разработчиков.

Когда мы говорим о создании групп участников на базе полного блокчейна, мы в целом имеем в виду очень специфическое академическое предложение, известное как Curve Trees. Curve Trees использует пару Bulletproofs, чтобы доказать, что выход существует в некотором дереве выходов. Причина, по которой это важно, заключается в том, что речь не идёт о каких-то доверенных настройках, Ethereum или доказательствах с нулевым разглашением. Нет, мы буквально говорим о технологии, которая уже есть в Monero - доказательства Bulletproofs. В настоящее время мы используем её для проверки выходов, о чём и говорится в следующем пункте.

И несмотря на то, что в настоящее время они используются для верификации сумм в выходах, мы можем использовать их для произвольных программ. И используя их таким образом мы сможем подтвердить: «Да, этот выход существует где-то в блокчейне».

Одна из проблем с Curve Trees, из-за которой мы не обсуждали это решение раньше - ну, мы обсуждали его до этого, но когда впервые столкнулись с ним, мы не были столь благосклонны, - проблема заключается в том, что оно предполагает наличие циклической кривой. Циклическая кривая - это математическая схема. Monero её не использует. И поэтому возникает вопрос - как нам задействовать циклическую кривую, если сейчас мы её не используем. Как сделать это?

Seraphis предоставляет идеальную возможность для этого. В случае с Seraphis нам придётся по новой создавать все адреса. И причина, по которой мы готовы сделать это, заключается в том, что Seraphis того стоит. Он привнесёт множество улучшений. В настоящее время идут разговоры о том, что после реализации Seraphis размер кольца увеличится с 16 до 128. Это огромное улучшение. Кроме того, протокол обеспечивает больший функционал. И дело не только в увеличении размера кольца, но и в предлагаемых ключах просмотра исходящих транзакций, того, чего мне отчаянно не хватало в моей работе с Monero.

И поскольку Seraphis выбрасывает все существующие адреса, если мы поменяем эллиптические кривые, то есть математическую основу Monero, это будет не так заметно. Мы уже отказываемся от старых криптографических механизмов, так почему бы не выкинуть ещё немного?

Чейз, Орру, Перрин и Заверуча, простите, если я неправильно произношу имена, в 2022 году опубликовали доказательство, позволяющее протоколам переключаться между эллиптическими кривыми. И благодаря этому доказательству, появившемуся в прошлом году, всё теперь обстоит не так просто, как «Круто, давайте выбросим криптографию со всеми вытекающими отсюда последствиями» - нет! Теперь у нас действительно есть способ сделать это, не нарушая приватности и не раскрывая суммы.

Технически, мы можем реализовать Curve Trees без циклической кривой, но потребует примерно половины производительности, поэтому я просто настаиваю на том, чтобы мы перешли к использованию циклической кривой в Seraphis.

И если мы не перейдём к её использованию, то не только производительность снизится вдвое, но нам придётся поддерживать эти четыре библиотеки до конца жизни. Сейчас мы используем кривую ED25519. Именно на её основе построена криптография Monero. И если мы не перейдём к использованию циклической кривой, которая, по сути, будет состоять из двух разных кривых, нам придется поддерживать ED25519, ещё одну библиотеку, а затем ещё две библиотеки вместо циклической кривой. В общем, если мы не перейдём к её использованию, то вдвое снизим пропускную способность, вдвое увеличим нагрузку на разработчиков, и всё это - одна сплошная боль. А Seraphis является просто идеальной возможностью для перехода. Лично я считаю, что это самая лучшая возможность избавиться от технических сложностей.

И теперь вопрос упирается реализацию. Разговоры о доказательствах участия на базе полного блокчейна, полагаю, ведутся уже около года. Примечательно, что Сет открыл тему на GitHub, Seth For Privacy, он открыл тему на GitHub около года назад, но вопрос обсуждается аж с 2018 года. Кажется, в одном из старых выпусков MRL говорилось о том, что Саранг и Серай уже много лет собираются рассмотреть вопрос о встраивании кода в доказательства  Bulletproofs, и академическая теория в этой связи также предусматривает подобные решения. Но, очевидно, в 2023 году этого так и не произошло. И теперь вопрос состоит в том, как нам двигаться дальше?

И я рад сообщить, что уже сделал это. Я фактически реализовал все обсуждаемые доказательства, начиная с Curve Trees и заканчивая доказательством участия членства и даже новой циклической кривой, которая в настоящее время является лучшим кандидатом для перехода.

Всё написано понятным языком, потому что это не просто доказательство концепции, это то, что я могу дать исследовательскому сообществу Monero в целом. И сообщество сможет взять его, усилить его и развернуть. Это не просто очередное доказательство концепции или фиктивный код, написанный на Python. Оно готово к тому, чтобы приступить к обсуждению реализации. И здесь присутствует много людей, с которыми я хотел бы это сделать.

Что касается производительности, это, безусловно, основной вопрос. Время транзакции точно не может составлять десять секунд. Поэтому, извините, это будет техническое примечание - когда вы проверяете одно из этих доказательств, всё происходит в два этапа. Есть пакетная проверка. Вы можете взять 10 доказательств и проверить их все сразу. Но есть и этап подготовки. Вы берёте отдельное доказательство, подготавливаете его, а затем отправляете верификатору, проверяющему пакеты. То есть здесь есть два разных сегмента. И, по-моему, в этом примечании нет необходимости, поскольку я удалил упоминание об этом отличии из остальной части презентации. Так что, прошу прощения.

Так что, доказательства проверяются пакетами, и сейчас это занимает 100 миллисекунд. Но это даёт нам 777 миллионов выходов, что, предположительно, что составляет запас Monero на ближайшее десятилетие. И если мы перешагнем отметку в 777 миллионов, мы просто повысим её. Нам не придётся перезагружать приватный пул.

Но и 100 миллисекунд - это не достаточно хорошо. Не думаю, что это вполне приемлемо. Но при определённой академической работе, которую я уже начал обсуждать с другими исследователями в этой области, в частности с криптографами из Firo, Арамом, непосредственно представляющим Firo, и Аароном, представляющим Cypherstack, который в настоящее время работает с Firo над их новым протоколом обеспечения приватности Lelantus Spark. Благодаря работе, которую я с ними обсуждаю, мы довольно быстро снизим скорость до 33 миллисекунд. И когда мы дойдем до 33 миллисекунд, это всё действительно станет очень реалистичным.

Доказательства Грутла, обсуждаемые в связи с Seraphis, которые доведут размер кольца до 128, работают 3,7 миллисекунды. Так что да, я говорю о 10-кратном замедлении, но дальнейшая оптимизация всё ещё доступна. В документе Curve Tree утверждается, что им удалось снизить скорость до 2 миллисекунд. И я думаю, что они посчитали это таким образом, с которым я не совсем согласен. Но я пытаюсь сказать, что если мы находимся в пределах порядка величины, то, несмотря на 10-кратное замедление, это определённо стоит того с точки зрения упрощения разработки, и не только упрощения разработки, но и реализации доказательства участия на базе полного блокчейна, в результате чего нам никогда больше не придётся беспокоиться о размере кольца. И даже когда это будет в пределах 10-кратного замедления, я действительно верю, что всё будет работать лишь в 3-5 раз медленнее. И это при размере кольца, который станет в 5 миллионов раз больше.

И ещё один вопрос - это то, о чём мне сказал Джастин Берман, Джей Берман. Производительность узла радикально изменится в целом. Сейчас значительную часть времени верификации транзакций занимает извлечение данных кольца с жёсткого диска с целью верификации подписи кольца. И это не та проблема, о которой я стал бы беспокоиться  - извлечение этих данных с диска. В случае с Curve Tree необходимость в этих данных исчезает по причине отсутствия самих колец. Есть и другие проблемы с производительностью при использовании Curve Tree. Нам приходится строить дерево. Поэтому вместо того, чтобы записывать каждый выход в базу данных, мы должны записать туда данные дерева. А вычисление данных дерева требует несколько иных затрат. Так что все компромиссы налицо, посмотрим, что из этого выйдет.

Что касается безопасности, тут я просто хотел бы ответить на несколько часто задаваемых вопросов. Это «лунная арифметика»? Именно так говорит большинство людей, когда речь заходит о технологии, популяризированной Zcash. И я бы ответил нет - это не лунная арифметика. Опять же, здесь используются доказательства Bulletproofs. Технически моё решение использует Bulletproofs+, доказательства, которые уже применяются Monero, уже проверены и поняты людьми в сообществе Monero. Это определенно требует больших знаний. Я не говорю, что собираюсь научить всех присутствующих, как именно работают доказательства Bulletproof - для этого есть презентация Амира, Амира Тааки. Он выступает в воскресенье, так ведь? Да, в воскресенье. Если вам интересно, там будет говориться о математических основах доказательства. Я не считаю себя формальным криптографом, но я смог всё понять. Я считаю, что если правильные люди из состава сообщества приложат определённые усилия, и мы продолжим общаться с действующими криптографами, с которыми мы уже общаемся, если мы всё так же будем ценить koe, если мы будем поддерживать контакты с другими сообществами, мы определённо сможем со всем справиться.

Как много из этого было формально доказано? Это именно тот вопрос, который я хотел включить в выступление и сделал это благодаря моему другу, который постоянно жалуется на формальные доказательства. «Формально доказано» означает «академически доказано, что это безопасно», если только академическое доказательство само не имеет недостатков. Но именно поэтому мы проверяем и академические доказательства. Bulletproofs, как уже было сказано, прошли проверку Monero. Они были формально доказаны, и так далее, и тому подобное. Curve Trees просто использует пару доказательств Bulletproofs, но это не значит, что Curve Trees формально доказаны. Я могу написать пару доказательств Bulletproofs для проверки программы и сделать её самой небезопасной из всех существующих. Так что Curve Trees как программа, которая проверяется с помощью Bulletproofs, должна быть проверена.

Однако это поднимает интересный вопрос. Хотим ли мы, чтобы это было формально доказано в академическом смысле, или мы хотим, чтобы это было формально проверено в смысле программирования? И это различие немного техническое. По сути, мы хотим сказать, что академическая теория разумна, или мы хотим сказать, что разумен сам код? Много исследований было проведено на эту тему благодаря смарт-контрактам Ethereum, которые формально проверяются и позволяют выполнять только определённые действия. И в случае с таким типом работы всё не так уж и академично. Это просто написание кода с математическими свойствами. И можно сказать, что всё это доказательства. В любом случае, это очень интересно. Сам по себе подход Curve Trees не доказан. Можно спорить, требует ли он доказательств. Я бы сказал, что некоторые его компоненты определённо должны быть доказаны. Но я считаю, что есть чёткий путь, и не думаю, что его преодоление  займёт несколько лет.

Единственная оговорка касается вопроса о том, что не было доказано формально? Технически, мы используем доказательства Bulletproofs, но для этого нам требуется нечто, называемое векторной схемой обязательств. Я не буду вдаваться в подробности. Это очень технично. Я расскажу об этом в следующем пункте. У нас нет доказательств для этого компонента. Поэтому нам нужны такие доказательства. Я считаю, что мы можем получить доказательства для текущей версии довольно быстро. Мне требуется обсудить это с некоторыми криптографами. Но в идеале мы должны её улучшить. Текущая версия довольно плоха. И если мы её улучшим, это займёт больше времени. Но я надеюсь, что когда дело дойдет до проверки безопасности, проверки академической безопасности, проверки правильности кода, я надеюсь, мы сможем подготовить всё к аудиту в течение шести-девяти месяцев, если задача станет действительно приоритетной. Зная, как происходит разработка Monero, я бы сказал, что это займёт около года, года и трёх месяцев. Но я очень надеюсь на обычные темпы разработки этого проекта.

Что касается обеспечения безопасности, это требует привлечения большего числа разработчиков, изучения методов формальной верификации, общения с аудиторами и привлечения криптографов. Сейчас я обсуждаю с одним из авторов одной из техник, использованных в доказательстве, Лиамом Иганом, создателем Bulletproofs++, улучшенной версии Bulletproofs+, которая в свою очередь является улучшенной версией Bulletproofs. Я обсуждал с ними проблему безопасности, и я планирую продолжить обсуждение. Так что это отдельная тема.

И это как бы подводит нас к следующему вопросу. Это формализация финансовой стороны. Она построена поверх уже формализованных техник. И я здесь не для того, чтобы утверждать обратное. Но, безусловно, когда внедряется что-либо новое, разработчик обязательно внесёт свою лепту. Потому что вы не можете просто взять лист бумаги и написать код, который напрямую будет соответствовать требуемому. Снова возникает схема векторных обязательств. И нам действительно придётся потратить на это время.

Ещё одна вещь, которую мы должны сделать, это формализация финансовой составляющей в доказательствах самого протокола Seraphis. Он предлагается как часть Seraphis. Это значит, что он может быть безопасным, как ожидается с точки зрения протокола, но это не значит, что Seraphis безопасен в целом. Формализация Seraphis в плане доказательств, полагаю, планировалась после завершения большей части разработки. В этой области ведётся много дискуссий и имеется множество ниш, в которые можно было бы забраться, но сейчас я просто скажу, что, обсуждая формализацию финансовой составляющей и доказательств в рамках текущей работы, мы также должны пересмотреть вопрос о том, чтобы в случае с Seraphis сделать это в более сжатые сроки.

Нужно ли ознакомить разработчиков с кодовой базой? Я уже связался с несколькими исследователями. Иганом, создавшим Bulletproofs++ и технику, непосредственно используемую в моей работе. Также я разговаривал с Амиром Тааки по поводу некоторых из этих работ. Как уже было сказано, я общался с криптографами из Firo. И, конечно, у нас есть великолепные разработчики Monero, с которыми мне еще предстоит обсудить эту тему, и я надеюсь сделать это сейчас.

И, наконец, вопрос о том, в каком направлении Seraphis должен двигаться дальше? Тут есть несколько вариантов. Мы можем продвигать Seraphis по плану, а через два года получить удар по производительности, в два раза медленнее производить верификацию доказательств и получить в два раза больше работы, связанной с сопровождением. И мы можем развернуть Seraphis, используя доказательство Грутла, доведя размер кольца до 128, но при этом необходимо перейти к использованию циклической кривой, за которой будущее. Или же мы можем начать обсуждение развёртывания Seraphis с доказательствами участия на базе полного блокчейна.

И наконец, работа над кодом, или, над кодовой базой, её преобразование в нечто, готовое к запуску. Я создал нечто подобное, но вовсе не утверждаю, что оно готово к полноценному использованию.

И наконец, найм аудиторов. Следует убедиться в том, что всё проверено от и до. Я не хочу внедрять или предлагать что-либо, что могло бы угрожать Monero, а предложение неработающего доказательства определённо угрожает Monero. Поэтому мы должны быть чертовски уверены, что всё сделали правильно. Вопросы, комментарии, замечания?
