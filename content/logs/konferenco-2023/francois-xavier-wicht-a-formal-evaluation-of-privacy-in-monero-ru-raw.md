---
title: "Франсуа-Ксавьер Вихт - Формальная оценка уровня приватности Monero"
date: "2023-06-24"
categories:
  - "Стенограмма"
tags:
  - "MoneroKon 2023"
lead: "Monero Konferenco 2023 #MoneroKon2023 Прага - День 2"
pager: true
toc: false
sidebar: "right"
---

{{< youtube id="Wa5Mcx2XemM" autoplay="false" >}}

---

_**Франсуа-Ксавьер:**_ Итак, это совместная работа с Жипенгом Вангом, Дюком Ли и Кристианом Кэчином.

Вот о чём мы поговорим сегодня: сначала небольшое вступление, после чего я представлю модель направленного ациклического графа приватных транзакций, где сам граф будет обозначен просто как DAG. Что касается понятий приватности, к ним я вернусь немного позже.

Итак, для начала поговорим о репрессивном государстве, полностью контролирующем обычную банковскую систему и способном запретить наличные платежи, установить массовую слежку и создать схему финансового принуждения.

И здесь появляется группа сопротивления. Это люди, которые быстро лишаются каких-либо финансовых средств, в результате чего децентрализованная криптовалюта становится для них одним из немногих способов выживания.

Репрессивному государству известно это, и поэтому оно сканирует и анализирует историю блокчейна такой криптовалюты, чтобы выявить основных его пользователей из состава группы сопротивления, их адреса, а также объём средств, находящихся в распоряжении группы.

Допустим, Лея регулярно оказывает финансовую поддержку группе сопротивления. Теперь возникает вопрос: насколько сильно Лея рискует, пользуясь при этом криптовалютой?

Чтобы ответить на этот вопрос, мы вводим формальную модель. Данная модель построена на базе направленного ациклического графа транзакций. Надеюсь, вам видно. Да, отлично. Просто на экране всё выглядит иначе. Итак, это граф. Он состоит из вершин и рёбер. При этом есть два типа вершин: состояния и свидетельства. А рёбра представляют собой транзакционные отношения между ними.

Что такое состояния и что такое свидетельства? Состояние – это отдельный актив в блокчейне, в то время как свидетельство является правилом проверки блокчейна. Например, одно из таких правил – убедиться в том, что пользователь обладает правом собственности на монету, которую собирается потратить. Другими словами, речь идёт о проверке подписи, например.

Далее у нас есть несколько типов рёбер. Так у нас есть рёбра потребления. Когда вы тратите монету, вы, по сути, потребляете её. И когда вы передаёте эту монету другому человеку, вы создаёте новое состояние. И это уже будут создающие рёбра. В некоторых случаях может понадобиться прочитать состояние, не изменяя его, например, если вы используете состояние в качестве ложного. И в этом случае можно наблюдать только эти состояния, равно как и соответствующие рёбра просмотра.

Я приведу пример с небольшой транзакцией. Здесь у нас есть состояние входа слева и состояние выхода справа. s0, s1 – это состояние входа, а s2 – выхода. Посередине находится свидетельство. Транзакция включает в себя ровно одно свидетельство. Например, эту маленькую транзакцию можно интерпретировать как то, что Элис перевела Бобу все свои монеты с двух адресов. Если бы она отдала только часть своих монет, то здесь было бы создано второе состояние, представляющее остаточную сумму.

Основное свойство этого графа состоит в том, что каждое состояние создаётся ровно один раз. Это свойство хэш-функции. И каждое состояние также потребляется не более одного раза. Нам ведь не нужны двойные траты, верно? Граф G слабо связан, что означает отсутствие "осиротевших" членов графа, и в G нет циклов.

У нас также имеется довольно удобная математическая нотация, которая, по сути, является реляционной. Так что любой путь в графе TDAG может быть представлен с помощью математической нотации. Возьмём путь от s0 к s2 – первое уравнение, где s0 – ребро потребления, свидетельство, создающее ребро s2, и то же самое мы имеем для пути от s1 к s2 с ребром просмотра.

Теперь с помощью этой модели мы можем представить блокчейн на основе UTXO, блокчейн на основе счетов. Но мы также хотим представить блокчейн на основе "нуллификаторов", как мы их называем. Такой как блокчейн Monero и Zcash, например.

Но проблема состоит в том, что в этом случае в графе TDAG будет недостаточно элементов для их представления. Потому что, как я уже сказал, в этих блокчейнах на основе нуллификаторов присутствует некоторая приватность. И если мы не видим состояния потребления, то добавляем ребро, маскирующее ребро, которое для всех невовлечённых сторон выглядит как ребро просмотра, но на самом деле играет роль ребра потребления. И, как мы уже определили, состояние может быть потреблено только один раз, верно?

Мы добавляем компонент, называемый "нуллификатором", поскольку при проведении каждой транзакции нам нужно выводить дополнительные компоненты, подтверждающие, что мы не тратим выход дважды. В Monero это, например, для этого используются образы ключей. Здесь они обозначены ромбом. Итак, мы строим транзакцию на базе графа TDAG и добавляем маскирующее ребро, а также добавляем нуллификаторы. В результате мы получаем граф DAG транзакции с сохранением приватности или сокращённо PDAG.

Теперь у нас есть определение графа PDAG, и мы можем более подробно поговорить о задаче обеспечения приватности. Начнём с моделирования действий злоумышленника, затем поговорим о неотслеживаемости и, если у останется время, о несвязываемости.

Итак, обозначим имеющийся у нас блокчейн как П. Злоумышленник A пассивен. Он просто наблюдает. Он не ограничен в вычислительных ресурсах, но при этом предполагается, что мы используем идеальную криптографию. И злоумышленник пытается скомпрометировать любое из свойств, связанных с приватностью, а именно неотслеживаемость и несвязываемость.

Что касается неотслеживаемости, свойство неотслеживаемости означает, что для каждого входящего поступающего состояния входа любое из них может быть потреблено с равной вероятностью. Таким образом, злоумышленник видит только неоднозначные рёбра, то есть либо рёбра просмотра, либо маскирующие рёбра. То есть, неоднозначные рёбра являются совокупностью маскирующих рёбер и рёбер просмотра. Но злоумышленник пытается устранить эту неоднозначность. Он пытается угадать, какое из рёбер на самом деле является маскирующим, а какое – ребром просмотра.

И здесь прекрасно видно, что у злоумышленника может только с одной третью вероятности угадать правильно. И здесь речь идёт только об одной транзакции. Мы утверждаем, что эта вероятность может быть уменьшена, если взять полный граф PDAG. Так что, следите за нашей дальнейшей работой.

Если речь идёт уже о трёх транзакциях, мы утверждаем, что их можно переставить в рамках двудольного графа. Справа – то, как всё видит злоумышленник, а слева – истинное положение вещей. А для определения ядра графа мы воспользовались работой Виджаякумарана и Эггера. Ядро – это совокупность всех максимальных совпадений. Почему мы берём именно его? Потому что состояние потребления создаётся в случае только одного максимального совпадения. А ядро – это объединение всех максимальных совпадений, и оно является подграфом двудольного графа, который я вам только что продемонстрировал, только подграфом рёбер.

Если кратко, злоумышленник, вычисляя ядро, может обрезать некоторые рёбра, уменьшив таким образом набор неотслеживаемых членов. Вернёмся к примеру, который я приводил ранее: у нас есть два максимальных совпадения, красное и синее, и у нас есть фиолетовое ребро, которое является частью обоих максимальных совпадений. Таким образом, мы можем обрезать эти два ребра, которые идут к w3, и обозначены точками. Так что, по сути, в данном случае происходит полная деанонимизация.

Это хорошо известное исследование, но оно направлено на формализацию фактической неотслеживаемости. Так что свойство неотслеживаемости здесь имеет значение, поскольку если ядро G не равно G, злоумышленник может обрезать некоторые рёбра, сократив таким образом набор неотслеживаемости. В противном случае, если ядро G равно G, берётся наименьшее свидетельство, которое угадывается случайным образом. И под наименьшим свидетельством я подразумеваю свидетельство с наименьшим количеством входящих рёбер.

И здесь используется моё первое определение – "k-неотслеживаемая транзакция". Если транзакция – это подграф ядра, что действительно важно, и без рёбер потребления, только с неоднозначными рёбрами, и этих неоднозначных рёбер должно быть не менее двух, и у нас есть это k, то это k означает количество неоднозначных рёбер. Таким образом, здесь показана k-неотслеживаемая транзакция. Но в данном случае рассматривается только одна транзакция. Поэтому, возьмём полный граф PDAG. Ведь граф PDAG – это, фактически, зеркало блокчейна.

Итак, берём полный граф PDAG. Этот граф фактически неотслеживаем вплоть до самых слабых транзакций, то есть транзакций с наименьшим k. И чтобы граф PDAG был k-неотслеживаемым, все транзакции должны быть k-неотслеживаемыми. Потому что при наличии единственного ребра потребления, видимого ребра потребления, полный граф PDAG не будет неотслеживаемым.

А теперь немного поговорим о Monero. Совсем недавно мы увеличили размер кольца до 16. Это ведь недавно? Или уже год назад? Прошу прощения, год назад. Спасибо. И поэтому, вне сомнений, если ядро G равно G, то значение k будет равно 16. То есть Monero является 16-неотслеживаемой.

А теперь возьмём Zcash. В случае Zcash у нас есть защищённый пул и прозрачный пул, но нас в данном случае интересует именно защищённый пул. В случае с защищённым пулом неотслеживаемость обеспечивается с помощью технологии zk-SNARKs. В наборе, обеспечивающем неотслеживаемость, нет списка открытых ключей. Такой набор по факту является неоднозначным и состоит из любых ранее созданных состояний. Поэтому граф PDAG в Zcash, если ядро G равно G, по сути, является наименьшим свидетельством с наименьшим набором ранее созданных для свидетельства состояний. По-моему, вчера речь шла о расширении набора, обеспечивающего неотслеживаемость Monero, до такого рода технологии с полным доказательством участия. Так что, возможно, за этим определением кроется будущее Monero.

Итак, не знаю, сколько времени у меня осталось, но следующее понятие, касающееся обеспечения приватности, – несвязываемость. Несвязываемость – это когда мы не можем связать два адреса с одним и тем же объектом. И эти два термина, неотслеживаемость и несвязываемость, на самом деле очень близки, но, по сути, они совершенно разные.

И теперь мы пытаемся абстрагировать связывание и абстрагировать это понятие объекта – мы определяем отношение эквивалентности L для множества состояний. И поскольку злоумышленник пытается разбить множество состояний, теперь мы используем уточнение этого отношения связи. Это адресное отношение, потому что в случае Bitcoin может быть несколько состояний с одинаковыми адресами. В Monero это невозможно.

И теперь задача злоумышленника сводится к идентификации состояний, которые принадлежат друг другу, но при этом ему не известно L. У него есть только предполагаемое отношение тильда L. L тильда, простите. И поэтому он пытается нарушить свойство несвязываемости с помощью этого предполагаемого отношения.

Это предполагаемое отношение напрямую связано с эвристическим подходом, описанным в различных работах. И с помощью нашей нотации графа PDAG мы можем описать эти эвристические подходы. Как здесь показано, наиболее распространённые эвристические подходы, которые используются в случае Bitcoin, связаны с несколькими входами, потому что в случае Bitcoin, если вы используете несколько адресов, в какой-то момент, чтобы вместе потратить выход, вам придётся объединить их обратно, и этот паттерн заметно выделяется, что было описано самим Накамото. Итак, в третьем уравнении мы видим, что для всех пар состояний в состоянии входа они могут быть связаны предполагаемым отношением.

И теперь, как уже было сказано, злоумышленник попытается нарушить свойство несвязываемости с помощью этого предполагаемого отношения. Но это отношение может быть неправильным. Поэтому может возникнуть дихотомия между L и L тильда, верно? И эта дихотомия, при условии, что злоумышленник отнесёт вас к неверному классу эквивалентности, обеспечит более высокий уровень приватности. По сути, такая дихотомия является источником приватности. И серая зона здесь – это, собственно, и есть набор, обеспечивающий несвязываемость.

Теперь кратко о наборе, обеспечивающем  несвязываемость. Размер этого набора – это далеко ещё не всё. Например, если у нас имеется набор с разницей в единицу, а здесь у нас набор несвязываемости с предполагаемым отношением 100 и истинным отношением 99, это совершенно другое дело, потому что появляется вероятность угадать правильно, равная 0,98, если сравнивать с вероятностью в одну треть. Поэтому нам необходимо подсчитать соотношение несвязанных пар. Я это называю "показателем несвязываемости". Показатель несвязываемости – это отношение несвязанных пар ко всем возможным парам.

Таким образом, мы имеем состояние u-несвязываемости, если значение u больше нуля. А если значение u равно единице, то состояние обладает свойством полной приватности. И, безусловно, по той же логике, что и до этого раньше, если все состояния будут u-несвязываемыми, мы получаем u-несвязываемый граф PDAG.

Теперь коротко о Bitcoin и CoinJoin. CoinJoin, по сути, обеспечивает устойчивость к эвристическому анализу по множеству входов. Приведу пример. Мы выделили цветом состояния, принадлежащие одному и тому же объекту. И в результате эвристического анализа по множеству входов все они попали бы в один класс эквивалентности. Но для s0 и s1, а также s2 и s3, поскольку они идентифицируются по парам, мы получаем показатель несвязываемости, составляющий от 10 до 21. Что касается s5 и s6, то это один и тот же объект, и здесь показатель составляет от 6 до 21. Таким образом, чем больше вкладывается в состояния входов, тем слабее свойство несвязываемости.

И здесь приводится лемма для этого показателя несвязываемости CoinJoin. И на этом я перехожу к заключению.

Я думаю, что показатель несвязываемости, этот максимальный показатель несвязываемости вполне можно использовать. Очевидно, что в случае с CoinJoin это возможно. И я считаю, что это можно назвать максимально реализуемым уровнем приватности. Этот показатель может быть использован кошельком или клиентами блокчейна. Так что, на мой взгляд, результаты любого эвристического анализа можно исказить подобным образом, верно?

Итак, вывод: можем ли мы определить другие нотации с помощью нашей модели? Можем ли мы сравнить все системы? Думаю, да. И каков достаточный уровень приватности? Как мы увидели, вот это значение k – вполне достаточно, верно? Или мы думаем, что на определённом этапе этого может быть достаточно. Спасибо за внимание.
